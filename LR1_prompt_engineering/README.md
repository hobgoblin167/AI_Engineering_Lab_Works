

# Лабораторная работа №1

## Промптинг локальных LLM

### Общая информация

В рамках лабораторной работы реализован скрипт для автоматического решения тестовых вопросов с использованием локальной открытой языковой модели.
Модель получает на вход текст вопроса, варианты ответов и тематическую категорию, после чего возвращает индекс правильного варианта ответа (индексация с 0).

Работа выполнена в соответствии с техническими ограничениями задания: используется локальная модель, запуск возможен на одной GPU NVIDIA T4, платные API и дообучение не применяются.

---

### Используемая модель

* **Модель:** Qwen3-14B
* **Формат:** GGUF (квантованная версия Q4_K_M)
* **Запуск:** через библиотеку `llama-cpp-python`
* **Контекст:** 6144 токенов

Модель загружается локально и используется в режиме chat completion.

---

### Структура входных данных

Входной CSV-файл должен содержать следующие колонки:

* `id` — идентификатор вопроса
* `question` — текст вопроса
* `options` — варианты ответа
* `category` — тематическая область

Результатом работы является CSV-файл с добавленной колонкой:

* `answer` — индекс выбранного варианта ответа (начиная с 0)

---

### Логика решения

1. Для каждого вопроса формируется системный промпт, указывающий модель как эксперта в соответствующей тематической области.
2. Пользовательский промпт содержит:

   * текст вопроса;
   * список вариантов ответа;
   * строго заданный формат вывода (`ответ: <номер варианта>`).
3. Ответ модели обрабатывается регулярным выражением.
4. В случае, если корректный индекс извлечь не удалось, в качестве ответа подставляется `0`.

---

### Параметры запуска

В коде предусмотрен параметр:

```python
START_IDX
```

Он определяет, с какой строки входного CSV начинается обработка.
Это используется для удобства отладки и частичного запуска.

* Для **полного прогона датасета** необходимо установить:

```python
START_IDX = 0
```

---

### Запуск скрипта

Скрипт запускается из командной строки и принимает два аргумента:

```bash
python main.py input.csv output.csv
```

где:

* `input.csv` — входной файл с вопросами;
* `output.csv` — выходной файл с колонкой `answer`.

---

### Воспроизводимость

* Используются фиксированные параметры генерации (`temperature`, `top_p`, `max_tokens`);
* Модель и формат входных данных полностью определены;
* При повторном запуске на той же модели и данных результаты воспроизводимы.

---

### Примечания

* Скрипт не использует внешние API и не требует интернет-доступа после загрузки модели.
* Код предназначен для работы в среде Google Colab или аналогичной, поддерживающей GPU NVIDIA T4.

---
